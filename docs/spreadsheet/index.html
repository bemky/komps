<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>Komps</title>
    <link href="/assets/site-dcaa840662e8a88cf6833670c3e0abb477a0de8b7144d0029bb77a12403bf332.css" rel="stylesheet" />
    <script src="/assets/site-a87bb3cf88e3a18c051f61cc6c8c8df7f24eed343d1ffd4bb12461a2af142ba4.js"></script>
</head>
<body>
    <div class="side-nav">
        <div class="pad-2x text-center">
            <a href="/" class="reset">
                <img class="width-3/4 height-auto inline-block" src="/assets/logo-7b1623d8d9db3b0d0d79dd30b2a5c2a0f0be2b945944f75d18e3be1e67177443.svg" />
            </a>
        </div>
        <div class="uniformNav -vertical -gray flex-fill -active-green">
            <a href="/" class="">
                Usage
            </a>
            <a href="/element" class="">
                Base Element
            </a>
            <div class="height-0 width-full">
                <div class="border-green-80 border-opacity-30 border-bottom border-1px width-full"></div>
            </div>
                <a href="/auto-grid" class="">
                    AutoGrid
                </a>
                <a href="/content-area" class="">
                    ContentArea
                </a>
                <a href="/data-table" class="">
                    DataTable
                </a>
                <a href="/dropdown" class="">
                    Dropdown
                </a>
                <a href="/dropzone" class="">
                    Dropzone
                </a>
                <a href="/floater" class="">
                    Floater
                </a>
                <a href="/input" class="">
                    Input
                </a>
                <a href="/modal" class="">
                    Modal
                </a>
                <a href="/notification-center" class="">
                    NotificationCenter
                </a>
                <a href="/spreadsheet" class="active">
                    Spreadsheet
                </a>
                <a href="/tooltip" class="">
                    Tooltip
                </a>
        </div>
    </div>
    <div class="main-content overflow-hidden">
        <div class="section space-v-3x">
    
    <div class="">
        <h1 class="text-2x text-overflow-hidden text-nowrap">
            Spreadsheet
            <span class="text-light text-italic text-gray-50 text-xl">
                (extends <a href="data-table" class="reset hover:text-underline">DataTable</a>)
            </span>
        </h1>
    
        <div class="text-light text-xl">
            <p>Render DataTable with editable cells</p>

        </div>
    </div>
    
    <div class="">
        <h2>Example</h2>
        <script>
            function resizeIframe(obj) {
                obj.style.minHeight = obj.contentWindow.document.documentElement.scrollHeight + 'px';
            }
        </script>
        <iframe class="overflow-hidden rounded-lg" width="100%" height="10px" src="/spreadsheet/example/index.html" frameborder="0" scrolling="no" onload="setTimeout(function () {resizeIframe(this)}.bind(this), 50)"></iframe>
    </div>
    
    <div class="">
        <h2>Syntax</h2>
        <div class="highlight"><pre class=" javascript"><code><span class="k">new</span> <span class="nx">Spreadsheet</span><span class="p">({</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Corey Seager</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">team</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Texas Rangers</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">ops</span><span class="p">:</span> <span class="mf">1.023</span><span class="p">,</span>
        <span class="na">avg</span><span class="p">:</span> <span class="mf">0.311</span><span class="p">,</span>
        <span class="na">positions</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">SS</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Marcus Semien</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">team</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Texas Rangers</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">ops</span><span class="p">:</span> <span class="mf">0.823</span><span class="p">,</span>
        <span class="na">avg</span><span class="p">:</span> <span class="mf">0.283</span><span class="p">,</span>
        <span class="na">positions</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">2B</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">}],</span>
    <span class="na">columns</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="p">{</span><span class="na">order</span><span class="p">:</span> <span class="kc">true</span><span class="p">},</span>
        <span class="na">team</span><span class="p">:</span> <span class="p">{},</span>
        <span class="na">ops</span><span class="p">:</span> <span class="p">[</span>
            <span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">ops</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^0/</span><span class="p">,</span> <span class="dl">''</span><span class="p">),</span>
            <span class="p">{</span>
                <span class="na">header</span><span class="p">:</span> <span class="dl">'</span><span class="s1">OPS</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">order</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>

    </div>
    
        <div class="">
            <h2>Options</h2>
                
                <table class="uniformTable border-gray-20">
                    <tr>
                        <th></th>
                            <th>types</th>
                            <th>description</th>
                            <th>default</th>
                    </tr>
                        <tr>
                            <td>
                                <code>content</code>
                            </td>
                                <td>
                                        String, HTMLElement, Array, Object
                                </td>
                                <td>
                                        <p>content to append to element. Passed to <a href="https://dollajs.com/#content">Dolla's <code>content</code></a></p>

                                </td>
                                <td>
                                        
                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>data</code>
                            </td>
                                <td>
                                        Array, Enumberable-ishObject
                                </td>
                                <td>
                                        <p>Each item of the array generates a row by passing the item to each render method of the defined columns. Uses calls <code>forEach</code> on object, so can use with any Enumerable-ish object.</p>

                                </td>
                                <td>
                                        
                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>columns</code>
                            </td>
                                <td>
                                        Object, Array
                                </td>
                                <td>
                                        <p>See Column Options</p>

                                </td>
                                <td>
                                        
                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>defaultColSize</code>
                            </td>
                                <td>
                                        String
                                </td>
                                <td>
                                        <p>Set the default size for columns</p>

                                </td>
                                <td>
                                        max-content
                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>reorder</code>
                            </td>
                                <td>
                                        Boolean, String
                                </td>
                                <td>
                                        <p>Enable ability to reoder rows and columns. Pass &quot;rows&quot; or &quot;cols&quot; to reorder just one axis.</p>

                                </td>
                                <td>
                                        true
                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>resize</code>
                            </td>
                                <td>
                                        Boolean, String
                                </td>
                                <td>
                                        <p>Enable ability to resize rows and columns. Pass &quot;rows&quot; or &quot;cols&quot; to reorder just one axis.</p>

                                </td>
                                <td>
                                        true
                                </td>
                        </tr>
                </table>
        </div>
        <div class="">
            <h2>Column Options</h2>
                <p>Columns are modeled by an Object that provides a key for each column and it's options.</p>
<div class="highlight"><pre class=" javascript"><code><span class="p">{</span>
    <span class="nl">render</span><span class="p">:</span> <span class="nx">player</span> <span class="o">=&gt;</span> <span class="nx">player</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
    <span class="nx">header</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Player Height</span><span class="dl">'</span><span class="p">,</span>
    <span class="nx">frozen</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>

                <table class="uniformTable border-gray-20">
                    <tr>
                        <th></th>
                            <th>types</th>
                            <th>arguments</th>
                            <th>description</th>
                    </tr>
                        <tr>
                            <td>
                                <code>render</code>
                            </td>
                                <td>
                                        Function
                                </td>
                                <td>
                                        item:Object, columnModel:Object, table:DataTable
                                </td>
                                <td>
                                        <p>Render method for the cell</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>header</code>
                            </td>
                                <td>
                                        Function, String
                                </td>
                                <td>
                                        columnModel:Object, table:DataTable
                                </td>
                                <td>
                                        <p>Render method for the header</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>width</code>
                            </td>
                                <td>
                                        String
                                </td>
                                <td>
                                        
                                </td>
                                <td>
                                        <p>Valid value for <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/grid-template-columns">css grid template</a> (i.e. px, percent, min-content...)</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>columns</code>
                            </td>
                                <td>
                                        Array
                                </td>
                                <td>
                                        
                                </td>
                                <td>
                                        <p>define nested columns within a column, only used for generating header cells that this column will span</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>frozen</code>
                            </td>
                                <td>
                                        Boolean
                                </td>
                                <td>
                                        
                                </td>
                                <td>
                                        <p>freeze this column to the side</p>

                                </td>
                        </tr>
                </table>
        </div>
        <div class="">
            <h2>Events</h2>
                
                <table class="uniformTable border-gray-20">
                    <tr>
                        <th></th>
                            <th>arguments</th>
                            <th>description</th>
                    </tr>
                        <tr>
                            <td>
                                <code>beforeRemove</code>
                            </td>
                                <td>
                                        []
                                </td>
                                <td>
                                        <p>called before element is removed</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>afterRemove</code>
                            </td>
                                <td>
                                        []
                                </td>
                                <td>
                                        <p>called after element is removed</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>beforeConnect</code>
                            </td>
                                <td>
                                        []
                                </td>
                                <td>
                                        <p>called before element is connected</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>afterConnect</code>
                            </td>
                                <td>
                                        []
                                </td>
                                <td>
                                        <p>called before element is connected</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>beforeDisconnect</code>
                            </td>
                                <td>
                                        []
                                </td>
                                <td>
                                        <p>called before element is disconnected</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>afterDisconnect</code>
                            </td>
                                <td>
                                        []
                                </td>
                                <td>
                                        <p>called before element is disconnected</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>rowResize</code>
                            </td>
                                <td>
                                        rowID:String, newSize:Integer, rowSizes:Array
                                </td>
                                <td>
                                        <p>fired when a row is resized</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>colResize</code>
                            </td>
                                <td>
                                        columnID:String, newSize:Integer
                                </td>
                                <td>
                                        <p>fired when a column is resized</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>rowReorder</code>
                            </td>
                                <td>
                                        newIndex:Integer, oldIndex:Integer
                                </td>
                                <td>
                                        <p>fired when a row is moved</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>colReorder</code>
                            </td>
                                <td>
                                        newIndex:Integer, oldIndex:Integer
                                </td>
                                <td>
                                        <p>fired when a column is moved</p>

                                </td>
                        </tr>
                        <tr>
                            <td>
                                <code>headerChange</code>
                            </td>
                                <td>
                                        columnID:String, newValue:String
                                </td>
                                <td>
                                        <p>fired when header is changed via default input for header</p>

                                </td>
                        </tr>
                </table>
        </div>
        <div class="">
            <h2>BUGS</h2>
                <ul>
<li>[ ] Dragging column over frozen column does not scroll panel</li>
<li>[ ] Grab reorder handle, and scroll opposite direction, and column shadow will cut off with scroll</li>
</ul>

        </div>
    
    <button class="js-toggle-source reset text-sm text-bold text-gray-30 hover:text-blue" rel="#source-for-spreadsheet">
        SHOW SOURCE
    </button>
    <div class="source hide" id="source-for-spreadsheet">
        <div class="border border-blue bg-blue rounded-xl overflow-hidden">
            <div class="text-white text-sm text-bold pad-h pad-v-1/4x">
                SOURCE CODE
            </div>
            <div class="highlight"><pre class=" javascript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createElement</span><span class="p">,</span> <span class="nx">listenerElement</span><span class="p">,</span> <span class="nx">remove</span><span class="p">,</span> <span class="nx">addEventListenerFor</span><span class="p">,</span> <span class="nx">getBoundingClientRect</span><span class="p">,</span> <span class="nx">insertAfter</span><span class="p">,</span> <span class="nx">insertBefore</span><span class="p">,</span> <span class="nx">content</span><span class="p">,</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">dolla</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">indexOfNode</span><span class="p">,</span> <span class="nx">closest</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">groupBy</span><span class="p">,</span> <span class="nx">placeCaretAtEnd</span><span class="p">,</span> <span class="nx">uniq</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../support.js</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">DataTable</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./data-table.js</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">KompElement</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./element.js</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Floater</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./floater.js</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ContentArea</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./content-area.js</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">handleIcon</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../icons.js</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">Spreadsheet</span> <span class="kd">extends</span> <span class="nx">DataTable</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="nx">tagName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">komp-spreadsheet</span><span class="dl">'</span>
    
    <span class="kd">static</span> <span class="nx">assignableAttributes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">reorder</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">],</span>
        <span class="na">resize</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">]</span>
    <span class="p">}</span>
    
    <span class="kd">constructor</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reorder</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">reorder</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">]</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reorder</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">reorder</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">reorder</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">string</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">reorder</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">reorder</span><span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resize</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">resize</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">]</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resize</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">resize</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">resize</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">string</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">resize</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rowTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-row`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">menuTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-input`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">reorderHandleTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">resizeHandleTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">dragBoxTag</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-drag-box`</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">button</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">selected</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span> 
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="k">return</span> 
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">initializeCellSelection</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mouseover</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showReorderHandleFor</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showResizeHandleFor</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">,</span> <span class="dl">'</span><span class="s1">keydown</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Escape</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
                    <span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">.</span><span class="nx">originalCell</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">({</span><span class="na">copySelection</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
                <span class="k">return</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="p">([</span><span class="dl">"</span><span class="s2">ArrowRight</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ArrowLeft</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ArrowDown</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ArrowUp</span><span class="dl">"</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">changeFocusByDirection</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^</span><span class="se">[</span><span class="sr">a-z0-0</span><span class="se">\-\_\$]</span><span class="sr">$/i</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">activateCellInput</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Enter</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRootNode</span><span class="p">().</span><span class="nx">activeElement</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">activateCellInput</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">,</span> <span class="dl">'</span><span class="s1">dblclick</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">activateCellInput</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
        <span class="p">})</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseleave</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-handle`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">contextmenu</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="nx">closest</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">renderContextMenu</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">})</span>
        
        <span class="c1">// Set Scoll Padding based on size change of frozen cells to make</span>
        <span class="c1">// scroll snapping happen on edge of frozen column instead of 0</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ResizeObserver</span><span class="p">((</span><span class="nx">entries</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">entry</span> <span class="k">of</span> <span class="nx">entries</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">scrollPaddingLeft</span> <span class="o">=</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">cell</span><span class="p">);</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="nx">connected</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">getRootNode</span><span class="p">())</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">manageEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getRootNode</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">paste</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">pasteCells</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">clipboardData</span><span class="p">.</span><span class="nx">getData</span><span class="p">(</span><span class="dl">"</span><span class="s2">text/plain</span><span class="dl">"</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">})</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">manageEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getRootNode</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">copy</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">copyCells</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="nx">remove</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">()</span>
        <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">observer</span>
        <span class="k">super</span><span class="p">.</span><span class="nx">remove</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="nx">initColumn</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">super</span><span class="p">.</span><span class="nx">initColumn</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">input</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultInput</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">copy</span> <span class="o">=</span> <span class="nx">record</span> <span class="o">=&gt;</span> <span class="nx">record</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">paste</span> <span class="o">=</span> <span class="p">(</span><span class="nx">record</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">record</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
        <span class="k">return</span> <span class="nx">model</span>
    <span class="p">}</span>
    
    <span class="nx">defaultRender</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">r</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">string</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">replaceAll</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&lt;br&gt;</span><span class="dl">"</span><span class="p">)}</span>
            <span class="k">return</span> <span class="nx">value</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nx">defaultHeader</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">headerOptions</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">header</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">headerOptions</span> <span class="o">!=</span> <span class="dl">"</span><span class="s2">object</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">headerOptions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">content</span><span class="p">:</span> <span class="nx">headerOptions</span> <span class="o">||</span> <span class="nx">key</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
            <span class="na">content</span><span class="p">:</span> <span class="nx">key</span><span class="p">,</span>
            <span class="na">class</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="s2">-input`</span><span class="p">,</span>
            <span class="na">input</span><span class="p">:</span> <span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">cell</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">ContentArea</span><span class="p">({</span>
                    <span class="na">value</span><span class="p">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">header</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span>
                    <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">padding</span><span class="p">:</span> <span class="nx">css</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="dl">'</span><span class="s1">padding</span><span class="dl">'</span><span class="p">)</span>
                    <span class="p">},</span>
                    <span class="na">onchange</span><span class="p">:</span> <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
                        <span class="nx">options</span><span class="p">.</span><span class="nx">header</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="nx">v</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">headerChange</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">},</span> <span class="nx">headerOptions</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="nx">renderHeader</span> <span class="p">(</span><span class="nx">column</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell`</span><span class="p">,</span> <span class="nx">column</span><span class="p">.</span><span class="nx">header</span><span class="p">)</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">,</span> <span class="nx">column</span><span class="p">.</span><span class="nx">frozen</span> <span class="o">===</span> <span class="kc">true</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span> <span class="p">:</span> <span class="kc">null</span><span class="p">)</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">columnModel</span> <span class="o">=</span> <span class="nx">column</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">content</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">result</span><span class="p">(</span><span class="nx">column</span><span class="p">.</span><span class="nx">header</span><span class="p">,</span> <span class="dl">'</span><span class="s1">content</span><span class="dl">'</span><span class="p">,</span> <span class="nx">column</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">cell</span>
    <span class="p">}</span>
    
    <span class="nx">defaultInput</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">cell</span><span class="p">,</span> <span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">r</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">keydown</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">!=</span> <span class="dl">"</span><span class="s2">Enter</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="dl">""</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="k">new</span> <span class="nx">ContentArea</span><span class="p">({</span>
                <span class="na">value</span><span class="p">:</span> <span class="nx">value</span><span class="p">,</span>
                <span class="na">class</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="s2">-input`</span><span class="p">,</span>
                <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">padding</span><span class="p">:</span> <span class="nx">css</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="dl">'</span><span class="s1">padding</span><span class="dl">'</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="na">onchange</span><span class="p">:</span> <span class="nx">v</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span>
            <span class="p">})</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nx">renderCell</span> <span class="p">(</span><span class="nx">record</span><span class="p">,</span> <span class="nx">column</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">super</span><span class="p">.</span><span class="nx">renderCell</span><span class="p">(</span><span class="nx">record</span><span class="p">,</span> <span class="nx">column</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span>
        <span class="nx">el</span><span class="p">.</span><span class="nx">record</span> <span class="o">=</span> <span class="nx">record</span>
        <span class="nx">el</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nx">el</span><span class="p">.</span><span class="nx">columnModel</span> <span class="o">=</span> <span class="nx">column</span>
        <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">,</span> <span class="nx">column</span><span class="p">.</span><span class="nx">frozen</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">el</span>
    <span class="p">}</span>
    
    <span class="nx">removeCell</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observe</span><span class="p">.</span><span class="nx">unobserve</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">super</span><span class="p">.</span><span class="nx">removeCell</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="nx">changeFocusByDirection</span><span class="p">(</span><span class="nx">direction</span><span class="p">,</span> <span class="nx">currentCell</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">currentCell</span> <span class="o">=</span> <span class="nx">currentCell</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">:focus, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">:focus-within`</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">currentCell</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">targetCell</span><span class="p">;</span>
            <span class="kd">let</span> <span class="nx">rowIndex</span> <span class="o">=</span> <span class="nx">currentCell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">rowIndex</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">header</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span> <span class="nx">rowIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">}</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">direction</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="dl">'</span><span class="s1">ArrowDown</span><span class="dl">'</span><span class="p">:</span> <span class="nx">targetCell</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`.row-</span><span class="p">${</span><span class="nx">rowIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">currentCell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="dl">'</span><span class="s1">ArrowUp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">targetCell</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`.row-</span><span class="p">${</span><span class="nx">rowIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">currentCell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="dl">'</span><span class="s1">ArrowLeft</span><span class="dl">'</span><span class="p">:</span> <span class="nx">targetCell</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`.row-</span><span class="p">${</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">currentCell</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="dl">'</span><span class="s1">ArrowRight</span><span class="dl">'</span><span class="p">:</span> <span class="nx">targetCell</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`.row-</span><span class="p">${</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">currentCell</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">targetCell</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">targetCell</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span>
            
                <span class="kd">let</span> <span class="nx">thisBB</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
                <span class="kd">const</span> <span class="nx">frozenRow</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.frozen-row`</span><span class="p">)</span>
                <span class="kd">const</span> <span class="nx">frozenCol</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.frozen-col`</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">frozenRow</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">thisBB</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">frozenRow</span><span class="p">.</span><span class="nx">offsetHeight</span>
                    <span class="nx">thisBB</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">frozenRow</span><span class="p">.</span><span class="nx">offsetHeight</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">frozenCol</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">thisBB</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">frozenCol</span><span class="p">.</span><span class="nx">offsetWidth</span>
                    <span class="nx">thisBB</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">width</span> <span class="o">-</span> <span class="nx">frozenCol</span><span class="p">.</span><span class="nx">offsetWidth</span>
                <span class="p">}</span>

                <span class="kd">let</span> <span class="nx">cellBB</span> <span class="o">=</span> <span class="nx">targetCell</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">unfreeze</span><span class="dl">'</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cellBB</span><span class="p">.</span><span class="nx">top</span> <span class="o">&lt;</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">top</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">({</span><span class="na">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">top</span><span class="p">:</span> <span class="nx">cellBB</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span> <span class="na">behavior</span><span class="p">:</span> <span class="dl">'</span><span class="s1">instant</span><span class="dl">'</span><span class="p">})</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cellBB</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&gt;</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">bottom</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">cellBB</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">-</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">bottom</span>
                    <span class="k">while</span> <span class="p">(</span><span class="nx">cellBB</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&gt;</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&amp;&amp;</span> <span class="nx">delta</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">({</span><span class="na">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">top</span><span class="p">:</span> <span class="nx">delta</span><span class="p">,</span> <span class="na">behavior</span><span class="p">:</span> <span class="dl">'</span><span class="s1">instant</span><span class="dl">'</span><span class="p">})</span>
                        <span class="nx">delta</span> <span class="o">+=</span> <span class="mi">5</span>
                        <span class="nx">cellBB</span> <span class="o">=</span> <span class="nx">targetCell</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cellBB</span><span class="p">.</span><span class="nx">left</span> <span class="o">&lt;</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">({</span><span class="na">left</span><span class="p">:</span> <span class="nx">cellBB</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="na">top</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">behavior</span><span class="p">:</span> <span class="dl">'</span><span class="s1">instant</span><span class="dl">'</span><span class="p">})</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cellBB</span><span class="p">.</span><span class="nx">right</span> <span class="o">&gt;</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">cellBB</span><span class="p">.</span><span class="nx">right</span> <span class="o">-</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">right</span>
                    <span class="k">while</span> <span class="p">(</span><span class="nx">cellBB</span><span class="p">.</span><span class="nx">right</span> <span class="o">&gt;</span> <span class="nx">thisBB</span><span class="p">.</span><span class="nx">right</span> <span class="o">&amp;&amp;</span> <span class="nx">delta</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">({</span><span class="na">left</span><span class="p">:</span> <span class="nx">delta</span><span class="p">,</span> <span class="na">top</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">behavior</span><span class="p">:</span> <span class="dl">'</span><span class="s1">instant</span><span class="dl">'</span><span class="p">})</span>
                        <span class="nx">delta</span> <span class="o">+=</span> <span class="mi">5</span>
                        <span class="nx">cellBB</span> <span class="o">=</span> <span class="nx">targetCell</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">unfreeze</span><span class="dl">'</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">let</span> <span class="nx">start</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.selection-start</span><span class="dl">'</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">start</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">currentCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selection-start</span><span class="dl">'</span><span class="p">)</span>
                        <span class="nx">start</span> <span class="o">=</span> <span class="nx">currentCell</span>
                    <span class="p">}</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">({</span><span class="na">selectionStart</span><span class="p">:</span> <span class="kc">false</span><span class="p">})</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">selectCells</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">targetCell</span><span class="p">)</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">({</span><span class="na">selectionStart</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nx">activateCellInput</span> <span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">({</span><span class="na">copySelection</span><span class="p">:</span> <span class="kc">true</span><span class="p">});</span>
        <span class="kd">let</span> <span class="nx">input</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">input</span> <span class="o">=</span> <span class="nx">result</span><span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">columnModel</span><span class="p">.</span><span class="nx">header</span><span class="p">,</span> <span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">columnModel</span><span class="p">,</span> <span class="nx">cell</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">input</span> <span class="o">=</span> <span class="nx">result</span><span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">columnModel</span><span class="p">,</span> <span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">record</span><span class="p">,</span> <span class="nx">cell</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">rowArea</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">)</span> <span class="p">?</span> <span class="dl">''</span> <span class="p">:</span> <span class="dl">'</span><span class="s1"> body</span><span class="dl">'</span>
            <span class="kd">const</span> <span class="nx">colArea</span> <span class="o">=</span> <span class="dl">'</span><span class="s1"> body</span><span class="dl">'</span>
            <span class="kd">const</span> <span class="nx">inputCell</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">input</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">content</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">tag</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-inputfield`</span><span class="p">,</span>
                    <span class="na">content</span><span class="p">:</span> <span class="nx">input</span>
                <span class="p">},</span>
                <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">gridArea</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">+</span> <span class="nx">rowArea</span><span class="p">,</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">+</span> <span class="nx">colArea</span><span class="p">,</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">+</span> <span class="nx">rowArea</span><span class="p">,</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">+</span> <span class="nx">colArea</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> / </span><span class="dl">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">})</span>
            <span class="nx">inputCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">))</span>
            <span class="nx">inputCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">))</span>
            <span class="nx">insertAfter</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">inputCell</span><span class="p">)</span>
            <span class="nx">inputCell</span><span class="p">.</span><span class="nx">originalCell</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">;</span>
            
            <span class="kd">const</span> <span class="nx">firstInput</span> <span class="o">=</span> <span class="nx">inputCell</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">input, textarea, button, [contenteditable]</span><span class="dl">'</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">firstInput</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">placeCaretAtEnd</span><span class="p">(</span><span class="nx">firstInput</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="nx">cell</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

            <span class="nx">inputCell</span><span class="p">.</span><span class="nx">beforeRemove</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">cell</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="nx">cell</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="nx">inputCell</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">focusout</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">inputCell</span><span class="p">.</span><span class="nx">beforeRemove</span><span class="p">()</span>
                <span class="nx">inputCell</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
            <span class="p">})</span>
            <span class="nx">inputCell</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">keydown</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Enter</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">].</span><span class="nx">every</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">==</span> <span class="kc">false</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">changeFocusByDirection</span><span class="p">(</span><span class="dl">'</span><span class="s1">ArrowDown</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">})</span>
        <span class="p">}</span>
    <span class="p">}</span>

    
    <span class="nx">renderContextMenu</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">anchor</span> <span class="o">==</span> <span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="kd">const</span> <span class="nx">canPaste</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span> <span class="o">!=</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">copyData</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Floater</span><span class="p">({</span>
            <span class="na">anchor</span><span class="p">:</span> <span class="nx">cell</span><span class="p">,</span>
            <span class="na">placement</span><span class="p">:</span> <span class="dl">'</span><span class="s1">right-end</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">shift</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">flip</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">autoPlacement</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">removeOnBlur</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">class</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu`</span><span class="p">,</span>
            <span class="na">content</span><span class="p">:</span> <span class="p">[</span>
                <span class="nx">listenerElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">button</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                    <span class="na">content</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Copy</span><span class="dl">'</span>
                <span class="p">},</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">copyCells</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>
                <span class="p">}),</span>
                <span class="nx">listenerElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">button</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                    <span class="na">content</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Paste</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">disabled</span><span class="p">:</span> <span class="o">!</span><span class="nx">canPaste</span>
                <span class="p">},</span> <span class="k">async</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">pasteCells</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">copyData</span><span class="p">)</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">pasteCells</span><span class="p">(</span><span class="k">await</span> <span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span><span class="p">())</span>
                    <span class="p">}</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>
                <span class="p">})</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span>
    <span class="p">}</span>
    
    <span class="c1">// -----------------</span>
    <span class="c1">// Column / Row Resizing</span>
    <span class="c1">// -----------------</span>
    <span class="nx">initializeAxisResize</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">axis</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">col</span><span class="dl">'</span>
        <span class="kd">const</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span>
        <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">rowIndex</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">colIndex</span><span class="dl">"</span>
        <span class="kd">const</span> <span class="nx">selectedIndex</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">start</span><span class="dl">'</span><span class="p">)</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
        <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">e</span><span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">y</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">]</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.</span><span class="p">${</span><span class="nx">axis</span><span class="p">}</span><span class="s2">-</span><span class="p">${</span><span class="nx">selectedIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">)[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">offsetHeight</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">offsetWidth</span><span class="dl">"</span><span class="p">]</span>
        <span class="kd">const</span> <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">uniq</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.header.selected`</span><span class="p">)).</span><span class="nx">map</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">])).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">selectedIndex</span><span class="p">)</span>
        <span class="kd">const</span> <span class="nx">handleOffset</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="kd">const</span> <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">scrollLeft</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">scrollTop</span><span class="dl">"</span><span class="p">]</span> <span class="o">-</span> <span class="k">this</span><span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">offsetLeft</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">offsetTop</span><span class="dl">"</span><span class="p">]</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">resizing</span><span class="dl">'</span><span class="p">)</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-drag-indicator`</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">class</span><span class="p">:</span> <span class="nx">axis</span><span class="p">,</span>
            <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">gridRow</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">gridColumn</span><span class="dl">"</span><span class="p">]:</span> <span class="dl">'</span><span class="s1">handles / -1</span><span class="dl">'</span>
            <span class="p">}</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">)</span>

        <span class="kd">let</span> <span class="nx">mouseMove</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">insetInlineStart</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">y</span><span class="dl">"</span><span class="p">]</span> <span class="o">+</span> <span class="nx">offset</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
        <span class="p">}</span>
        <span class="nx">mouseMove</span> <span class="o">=</span> <span class="nx">mouseMove</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>

        <span class="kd">let</span> <span class="nx">mouseUp</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">e</span><span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">y</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">]</span> <span class="o">-</span> <span class="nx">start</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">}</span>
            <span class="kd">let</span> <span class="nx">sizes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">`gridTemplate</span><span class="p">${</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">Rows</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">Columns</span><span class="dl">'</span><span class="p">}</span><span class="s2">`</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2"> [body] </span><span class="dl">"</span><span class="p">)</span>
            <span class="nx">indexes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">index</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">sizes</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">delta</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            <span class="p">})</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">`gridTemplate</span><span class="p">${</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">Rows</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">Columns</span><span class="dl">'</span><span class="p">}</span><span class="s2">`</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sizes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> [body] </span><span class="dl">"</span><span class="p">)</span>
            
            <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_columns</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">indexes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">index</span> <span class="o">=&gt;</span> <span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span><span class="p">),</span> <span class="s2">`</span><span class="p">${</span><span class="nx">axis</span><span class="p">}</span><span class="s2">Resize`</span><span class="p">,</span>  <span class="nx">delta</span><span class="p">)</span>
            
            <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
            <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">resizing</span><span class="dl">'</span><span class="p">)</span>
            
            <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousemove</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseMove</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseUp</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nx">mouseUp</span> <span class="o">=</span> <span class="nx">mouseUp</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousemove</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseMove</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseUp</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="nx">showResizeHandleFor</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resizeHandleTag</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">content</span><span class="p">:</span> <span class="p">[{</span><span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">start</span><span class="dl">'</span><span class="p">},</span> <span class="p">{</span><span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">}]</span>
            <span class="p">})</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">manageEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">initializeAxisResize</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resizeHandleTag</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">content</span><span class="p">:</span> <span class="p">[{</span><span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">start</span><span class="dl">'</span><span class="p">},</span> <span class="p">{</span><span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">}]</span>
            <span class="p">})</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">manageEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">initializeAxisResize</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">resizing</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridArea</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> / </span><span class="dl">"</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">hide-start</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">col-1</span><span class="dl">'</span><span class="p">))</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">hide-end</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="s2">`col-</span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2">`</span><span class="p">))</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">row-header</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">colResizeHandle</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridArea</span> <span class="o">=</span> <span class="p">[</span><span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> / </span><span class="dl">"</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">col-1</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">rowResizeHandle</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
    
    <span class="c1">// -----------------</span>
    <span class="c1">// Column / Row Move</span>
    <span class="c1">// -----------------</span>
    <span class="nx">initializeAxisReorder</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">axis</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">col</span><span class="dl">'</span>
        <span class="kd">const</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span>
        <span class="kd">let</span> <span class="nx">lastCell</span><span class="p">;</span>
        
        <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">setDragImage</span><span class="p">(</span><span class="nx">createElement</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">({</span><span class="na">copySelection</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragStartIndex</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">colIndex</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetLeft</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">handle</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragStartIndex</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">rowIndex</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetTop</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.row-</span><span class="p">${</span><span class="nx">handle</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridArea</span> <span class="o">=</span> <span class="kc">null</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">reordering</span><span class="dl">'</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-drag-indicator`</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">class</span><span class="p">:</span> <span class="nx">axis</span><span class="p">,</span>
            <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">gridRow</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">gridColumn</span><span class="dl">"</span><span class="p">]:</span> <span class="dl">'</span><span class="s1">handles / -1</span><span class="dl">'</span>
            <span class="p">}</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">)</span>
        
        <span class="kd">let</span> <span class="nx">dragOver</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
            <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="nx">closest</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">reorderHandleTag</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
            <span class="nx">lastCell</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetLeft</span>
                <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="nx">x</span>
                <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollWidth</span> <span class="o">-</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollWidth</span> <span class="o">-</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="p">:</span> <span class="nx">x</span>
                <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            
                <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridColumn</span> <span class="o">=</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2"> / body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dragStartIndex</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetTop</span>
                <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="nx">y</span>
                <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollHeight</span> <span class="o">-</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollHeight</span> <span class="o">-</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="p">:</span> <span class="nx">y</span>
                <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">px</span><span class="dl">"</span>
            
                <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridRow</span> <span class="o">=</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2"> / body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dragStartIndex</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">dragOver</span> <span class="o">=</span> <span class="nx">dragOver</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
        
        <span class="kd">let</span> <span class="nx">drop</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="nx">closest</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">reorderHandleTag</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="o">||</span> <span class="nx">lastCell</span>
            <span class="nx">lastCell</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">colIndex</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">rowIndex</span><span class="dl">"</span>
                <span class="kd">const</span> <span class="nx">gridAxis</span> <span class="o">=</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">gridColumn</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">gridRow</span><span class="dl">"</span>
                <span class="kd">const</span> <span class="nx">newIndex</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span>
                <span class="kd">const</span> <span class="nx">oldIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dragStartIndex</span>
                <span class="kd">const</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">newIndex</span> <span class="o">&gt;</span> <span class="nx">oldIndex</span> <span class="p">?</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">axis</span><span class="p">}</span><span class="s2">-</span><span class="p">${</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]}</span><span class="s2">`</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">==</span> <span class="nx">oldIndex</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newIndex</span>
                        <span class="kd">const</span> <span class="nx">anchorIndex</span> <span class="o">=</span> <span class="nx">newIndex</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="kd">const</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">delta</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">?</span> <span class="nx">insertAfter</span> <span class="p">:</span> <span class="nx">insertBefore</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">col</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">method</span><span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">anchorIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">),</span> <span class="nx">cell</span><span class="p">)</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="kd">const</span> <span class="nx">anchor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.row-</span><span class="p">${</span><span class="nx">anchorIndex</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">parentElement</span>
                            <span class="nx">method</span><span class="p">(</span><span class="nx">anchor</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">==</span> <span class="nx">newIndex</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">delta</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">oldIndex</span><span class="p">,</span> <span class="nx">newIndex</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">oldIndex</span><span class="p">,</span> <span class="nx">newIndex</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">delta</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">axis</span><span class="p">}</span><span class="s2">-</span><span class="p">${</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]}</span><span class="s2">`</span><span class="p">)</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">`</span><span class="p">${</span><span class="nx">gridAxis</span><span class="p">}</span><span class="s2">Start`</span><span class="p">]</span> <span class="o">=</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]}</span><span class="s2">`</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">`</span><span class="p">${</span><span class="nx">gridAxis</span><span class="p">}</span><span class="s2">End`</span><span class="p">]</span> <span class="o">=</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]}</span><span class="s2">`</span>
                        <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">axis</span><span class="p">}</span><span class="s2">-</span><span class="p">${</span><span class="nx">cell</span><span class="p">[</span><span class="nx">index</span><span class="p">]}</span><span class="s2">`</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">})</span>
                <span class="kd">let</span> <span class="nx">sizes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">`gridTemplate</span><span class="p">${</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">Rows</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">Columns</span><span class="dl">'</span><span class="p">}</span><span class="s2">`</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2"> [body] </span><span class="dl">"</span><span class="p">)</span>
                <span class="kd">const</span> <span class="nx">indexSize</span> <span class="o">=</span> <span class="nx">sizes</span><span class="p">[</span><span class="nx">oldIndex</span><span class="p">]</span>
                <span class="nx">sizes</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">oldIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="nx">sizes</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">newIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">indexSize</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">`gridTemplate</span><span class="p">${</span><span class="nx">axis</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">Rows</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">Columns</span><span class="dl">'</span><span class="p">}</span><span class="s2">`</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sizes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> [body] </span><span class="dl">"</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">axis</span><span class="p">}</span><span class="s2">Reorder`</span><span class="p">,</span> <span class="nx">newIndex</span><span class="p">,</span> <span class="nx">oldIndex</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selecting`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">)</span>
                <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selected</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">}</span>
        <span class="nx">drop</span> <span class="o">=</span> <span class="nx">drop</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
        
        <span class="kd">let</span> <span class="nx">dragEnd</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="nx">lastCell</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selecting, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selected`</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
            <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">dragIndicator</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">reordering</span><span class="dl">'</span><span class="p">)</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="dl">''</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="dl">''</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">''</span>
            <span class="nx">handle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="dl">''</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showReorderHandleFor</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selecting`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">})</span>
            
            <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">dragover</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dragOver</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">drop</span><span class="dl">'</span><span class="p">,</span> <span class="nx">drop</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">dragend</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dragEnd</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nx">dragEnd</span> <span class="o">=</span> <span class="nx">dragEnd</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">dragover</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dragOver</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">drop</span><span class="dl">'</span><span class="p">,</span> <span class="nx">drop</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">dragend</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dragEnd</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="nx">showReorderHandleFor</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">reorder</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reorderHandleTag</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">draggable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="na">content</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">content</span><span class="p">:</span> <span class="nx">handleIcon</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">})</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">manageEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">,</span> <span class="dl">'</span><span class="s1">dragstart</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">initializeAxisReorder</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">reorder</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reorderHandleTag</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">row</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">draggable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="na">content</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">content</span><span class="p">:</span> <span class="nx">handleIcon</span><span class="p">({</span><span class="na">horizontal</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
                <span class="p">}</span>
            <span class="p">})</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">manageEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">,</span> <span class="dl">'</span><span class="s1">dragstart</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">initializeAxisReorder</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">reordering</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridArea</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">handles</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">handles</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> / </span><span class="dl">"</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">colReorderHandle</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">.</span><span class="nx">rowIndex</span> <span class="o">=</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">.</span><span class="nx">colIndex</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridArea</span> <span class="o">=</span> <span class="p">[</span><span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">handles</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="dl">'</span><span class="s1">handles</span><span class="dl">'</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> / </span><span class="dl">"</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rowReorderHandle</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// -----------------</span>
    <span class="c1">// Cell Selection</span>
    <span class="c1">// -----------------</span>
    <span class="nx">initializeCellSelection</span> <span class="p">(</span><span class="nx">startCell</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">getRootNode</span><span class="p">())</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">()</span>
            <span class="nx">startCell</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">:focus`</span><span class="p">)</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="kd">const</span> <span class="nx">mouseOver</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">overCell</span> <span class="o">=</span> <span class="nx">closest</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">overCell</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selecting`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">))</span>
                <span class="kd">const</span> <span class="nx">colsMinMax</span> <span class="o">=</span> <span class="p">[</span><span class="nx">startCell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">,</span> <span class="nx">overCell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">startCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">colIndex</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(...</span><span class="nx">colsMinMax</span><span class="p">);</span> <span class="nx">colIndex</span> <span class="o">&lt;=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">colsMinMax</span><span class="p">);</span> <span class="nx">colIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`.col-</span><span class="p">${</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">))</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">rowsMinMax</span> <span class="o">=</span> <span class="p">[</span><span class="nx">startCell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">overCell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">]</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">rowIndex</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(...</span><span class="nx">rowsMinMax</span><span class="p">);</span> <span class="nx">rowIndex</span> <span class="o">&lt;=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">rowsMinMax</span><span class="p">);</span> <span class="nx">rowIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">colIndex</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(...</span><span class="nx">colsMinMax</span><span class="p">);</span> <span class="nx">colIndex</span> <span class="o">&lt;=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">colsMinMax</span><span class="p">);</span> <span class="nx">colIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="kd">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`.row-</span><span class="p">${</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">target</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">)</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">mouseOver</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">startCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">mouseOver</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="kd">const</span> <span class="nx">mouseUp</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">endCell</span> <span class="o">=</span> <span class="nx">closest</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">startCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">header</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">endCell</span> <span class="o">&amp;&amp;</span> <span class="nx">endCell</span> <span class="o">!=</span> <span class="nx">startCell</span><span class="p">))</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">selectingCells</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selecting`</span><span class="p">)</span>
                <span class="nx">selectingCells</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">selecting</span><span class="dl">'</span><span class="p">))</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">selectCells</span><span class="p">(...</span><span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">selectingCells</span><span class="p">))</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">?.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">endCell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">selected</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseover</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseOver</span><span class="p">)</span>
            <span class="nx">startCell</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">getRootNode</span><span class="p">().</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseUp</span><span class="p">,</span> <span class="p">{</span><span class="na">once</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseover</span><span class="dl">'</span><span class="p">,</span> <span class="nx">mouseOver</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="cm">/*
        options
        ----
        outline:
            type: String, Boolean
            description: if string, then that string used as tagName
        class:
            type: String
            description: class to add to cells
    */</span>
    <span class="nx">selectCells</span> <span class="p">(...</span><span class="nx">cells</span><span class="cm">/* [options={}]*/</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">cells</span><span class="p">[</span><span class="nx">cells</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">HTMLElement</span> <span class="p">?</span> <span class="p">{}</span> <span class="p">:</span> <span class="nx">cells</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
        <span class="nx">options</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
            <span class="na">outline</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">class</span><span class="p">:</span> <span class="dl">'</span><span class="s1">selected</span><span class="dl">'</span>
        <span class="p">},</span> <span class="nx">options</span><span class="p">)</span>
        
        <span class="kd">const</span> <span class="nx">min</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(...</span><span class="nx">a</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">number</span><span class="dl">"</span><span class="p">))</span>
        <span class="kd">const</span> <span class="nx">max</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">a</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">number</span><span class="dl">"</span><span class="p">))</span>
        <span class="kd">const</span> <span class="nx">sequence</span> <span class="o">=</span> <span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[...</span><span class="nb">Array</span><span class="p">(</span><span class="nx">end</span> <span class="o">-</span> <span class="nx">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="nx">fill</span><span class="p">().</span><span class="nx">map</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">start</span><span class="p">)]</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="kd">let</span> <span class="nx">rowIndexes</span> <span class="o">=</span> <span class="nx">cells</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">rowIndex</span><span class="p">)</span>
        <span class="nx">rowIndexes</span> <span class="o">=</span> <span class="nx">rowIndexes</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">header</span><span class="dl">"</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">min</span><span class="p">(</span><span class="nx">rowIndexes</span><span class="p">),</span> <span class="nx">max</span><span class="p">(</span><span class="nx">rowIndexes</span><span class="p">)))</span>
        
        <span class="kd">let</span> <span class="nx">colIndexes</span> <span class="o">=</span> <span class="nx">cells</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">colIndex</span><span class="p">)</span>
        <span class="nx">colIndexes</span> <span class="o">=</span> <span class="nx">colIndexes</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">header</span><span class="dl">"</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">min</span><span class="p">(</span><span class="nx">colIndexes</span><span class="p">),</span> <span class="nx">max</span><span class="p">(</span><span class="nx">colIndexes</span><span class="p">)))</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="kd">class</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">rowIndexes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">rowIndex</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">colIndexes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">colIndex</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`.row-</span><span class="p">${</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">.col-</span><span class="p">${</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">target</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="kd">class</span><span class="p">)</span>
                        <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">})</span>
            <span class="p">})</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">outline</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">tagName</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">outline</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">string</span><span class="dl">"</span> <span class="p">?</span> <span class="nx">options</span><span class="p">.</span><span class="nx">outline</span> <span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-selection`</span>
            <span class="kd">const</span> <span class="nx">frame</span> <span class="o">=</span> <span class="nx">createElement</span><span class="p">(</span><span class="nx">tagName</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">gridArea</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">rowIndexes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="nx">colIndexes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="nx">rowIndexes</span><span class="p">[</span><span class="nx">rowIndexes</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="nx">colIndexes</span><span class="p">[</span><span class="nx">colIndexes</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="nx">i</span> <span class="o">=&gt;</span> <span class="nx">i</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">header</span><span class="dl">"</span> <span class="p">?</span> <span class="nx">i</span> <span class="p">:</span> <span class="s2">`body </span><span class="p">${</span><span class="nx">i</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> / </span><span class="dl">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">})</span>
            <span class="nx">frame</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">includes-frozen-row</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cells</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-row</span><span class="dl">'</span><span class="p">)))</span>
            <span class="nx">frame</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">includes-frozen-col</span><span class="dl">'</span><span class="p">,</span> <span class="nx">cells</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">frozen-col</span><span class="dl">'</span><span class="p">)))</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">frame</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">result</span>
    <span class="p">}</span>
    
    <span class="nx">deselectCells</span> <span class="p">(</span><span class="nx">options</span><span class="o">=</span><span class="p">{})</span> <span class="p">{</span>
        <span class="nx">options</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
            <span class="na">selected</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">selection</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">inputfield</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">selectionStart</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">copySelection</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="p">},</span> <span class="nx">options</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">selected</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selected`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">selected</span><span class="dl">'</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">selection</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-selection`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">inputfield</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">-inputfield`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">el</span><span class="p">.</span><span class="nx">beforeRemove</span><span class="p">()</span>
                <span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">selectionStart</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selection-start`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">selection-start</span><span class="dl">'</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">copySelection</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nx">selectedCells</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">selectedCells</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">.selected, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">:focus, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span><span class="p">}</span><span class="s2">:focus-within`</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">selectedCells</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">selectedCells</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">anchor</span><span class="p">]</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">groupBy</span><span class="p">(</span><span class="nx">selectedCells</span><span class="p">,</span> <span class="dl">'</span><span class="s1">rowIndex</span><span class="dl">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">rows</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">rowIndex</span> <span class="o">=&gt;</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">])</span>
    <span class="p">}</span>
    
    <span class="c1">// -----------------</span>
    <span class="c1">// Copy / Paste</span>
    <span class="c1">// -----------------</span>
    <span class="nx">copyCells</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">selectedCells</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectedCells</span><span class="p">()</span>
        <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectedCells</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="nx">row</span> <span class="o">=&gt;</span> <span class="nx">row</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">columnModel</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">record</span><span class="p">)</span>
        <span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\t</span><span class="dl">"</span><span class="p">)).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">)</span>
        <span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">writeText</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">copyData</span> <span class="o">=</span> <span class="nx">data</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">deselectCells</span><span class="p">({</span><span class="na">copySelection</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">selectCells</span><span class="p">(...</span><span class="nx">selectedCells</span><span class="p">.</span><span class="nx">flat</span><span class="p">(),</span> <span class="p">{</span><span class="na">outline</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection`</span><span class="p">})</span>
    <span class="p">}</span>
    
    <span class="nx">pasteCells</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">selectedCells</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectedCells</span><span class="p">()</span>
        <span class="kd">const</span> <span class="nx">pasteMatrix</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="se">\t</span><span class="dl">"</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">selectedCells</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">selectedCells</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">selectedCell</span> <span class="o">=</span> <span class="nx">selectedCells</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="kd">let</span> <span class="nx">rowIndex</span> <span class="o">=</span> <span class="nx">selectedCell</span><span class="p">.</span><span class="nx">rowIndex</span>
            <span class="kd">const</span> <span class="nx">targets</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="nx">pasteMatrix</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">row</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">colIndex</span> <span class="o">=</span> <span class="nx">selectedCell</span><span class="p">.</span><span class="nx">colIndex</span>
                <span class="nx">row</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">cellValue</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cellTag</span> <span class="o">+</span> <span class="s2">`.col-</span><span class="p">${</span><span class="nx">colIndex</span><span class="p">}</span><span class="s2">.row-</span><span class="p">${</span><span class="nx">rowIndex</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">pasteCell</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">cellValue</span><span class="p">)</span>
                        <span class="nx">targets</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="nx">colIndex</span><span class="o">++</span>
                <span class="p">})</span>
                <span class="nx">rowIndex</span><span class="o">++</span>
            <span class="p">})</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">selectCells</span><span class="p">(...</span><span class="nx">targets</span><span class="p">)</span>
            <span class="nx">selectedCell</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">rowIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="nx">selectedCells</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">row</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">rowIndex</span> <span class="o">=</span> <span class="nx">rowIndex</span> <span class="o">==</span> <span class="nx">pasteMatrix</span><span class="p">.</span><span class="nx">length</span> <span class="p">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="nx">rowIndex</span>
                <span class="kd">let</span> <span class="nx">colIndex</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="nx">row</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">cell</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="nx">colIndex</span> <span class="o">=</span> <span class="nx">colIndex</span> <span class="o">==</span> <span class="nx">pasteMatrix</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">].</span><span class="nx">length</span> <span class="p">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="nx">colIndex</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">pasteCell</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">pasteMatrix</span><span class="p">[</span><span class="nx">rowIndex</span><span class="p">][</span><span class="nx">colIndex</span><span class="p">])</span>
                    <span class="nx">colIndex</span><span class="o">++</span>
                <span class="p">})</span>
                <span class="nx">rowIndex</span><span class="o">++</span>
            <span class="p">})</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection`</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span> <span class="o">=&gt;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
    <span class="p">}</span>
    
    <span class="nx">pasteCell</span><span class="p">(</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">columnModel</span><span class="p">.</span><span class="nx">paste</span><span class="p">(</span><span class="nx">cell</span><span class="p">.</span><span class="nx">record</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kd">static</span> <span class="nx">style</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">`
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> {
            --select-color: #1a73e8;
            --handle-size: 10px;
            position: relative;
            overflow: scroll;
            scroll-snap-type: both mandatory;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">.unfreeze .frozen-col,
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">.unfreeze .frozen-row {
            position: relative;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell {
            cursor: cell;
            user-select: none;
            position: relative;
            scroll-snap-stop: always;
            scroll-snap-align: start;
            overflow: hidden;
            white-space: nowrap;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> .frozen-col,
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> .frozen-row {
            position: sticky;
            left: 0;
            top: auto;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> .frozen-row {
            top: 0;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell:focus {
            box-shadow: inset 0 0 0 1px var(--select-color), 0 0 0 1px var(--select-color);
            outline: none;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell.selecting,
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell.selected {
            box-shadow: inset 0 0 0 999px rgba(26, 115, 232, 0.1);
            &amp;:focus {
                box-shadow: inset 0 0 0 999px rgba(26, 115, 232, 0.1), inset 0 0 0 1px var(--select-color), 0 0 0 1px var(--select-color);
            }
        }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-selection {
            pointer-events: none;
            border: 1px solid var(--select-color);
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection {
            pointer-events: none;
            border: 2px dashed var(--select-color);
        }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell.input {
            overflow: visible;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-inputfield {
            position: absolute;
            top: 0;
            left: 0;
            min-width: 100%;
            min-height: 100%;
            box-shadow: inset 0 0 0 1px var(--select-color), 0 0 0 1px var(--select-color), 0 0 0 3px rgba(26, 115, 232, 0.5);
            background: white;
            display: flex;
            flex-direction: column;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-input {
            min-width: 100%;
            outline: none;
            border: none;
            background: none;
            flex: 1 0 auto;
            white-space: nowrap;
        }
        
        .</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu {
            border-radius: 0.35em;
            background: white;
            padding: 0.5em;
            font-size: 0.8em;
            box-shadow: 0 2px 12px 2px rgba(0,0,0, 0.2), 0 1px 2px 1px rgba(0,0,0, 0.3);
        }
        .</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu &gt; button {
            display: block;
            outline: none;
            appearance: none;
            border: none;
            background:none;
            padding: 0.2em 0.5em;
            border-radius: 0.25em;
        }
        .</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu &gt; button:disabled {
            opacity: 0.5;
        }
        .</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu &gt; button:disabled:hover {
            background: white;
            color: inherit;
        }
        .</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu &gt; button:hover {
            background: var(--select-color);
            color: white;
        }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle {
            position: sticky;
            block-size-start: 0;
            pointer-events: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: col-resize;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle.row {
            writing-mode: vertical-lr;
            cursor: row-resize;
            block-size: 20px;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle .start,
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle .end {
            pointer-events: auto;
            block-size: 50%;
            inline-size: 11px;
            border: 3px none currentColor;
            border-inline-style: solid;
            opacity: 0.2;
            margin-inline: -6px;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle .start:hover,
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle .end:hover {
            opacity: 1;
            border-color: var(--select-color);
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle.hide-start .start {
            pointer-events: none;
            opacity: 0;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle.hide-end .end {
            pointer-events: none;
            opacity: 0;
        }

        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle {
            position: sticky;
            inset-block-start: 0;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle.row {
            writing-mode: vertical-lr;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">.reordering </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell {
            cursor: grabbing;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">.reordering </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle {
            position: absolute;
            background: rgba(0,0,0, 0.2);
            block-size: 100%;
            pointer-events: none;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle &gt; * {
            top: 1px;
            inline-size: 100%;
            block-size: var(--handle-size);
            display: flex;
            cursor: grab;
            justify-content: center;
            padding-block-start: 2px;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle &gt; *:hover {
            background: rgba(26, 115, 232, 0.1);
        }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-drag-indicator {
            pointer-events: none;
            position: absolute;
            block-size: 100%;
            inline-size: 3px;
            inset-block-start: 0;
            background: var(--select-color);
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-drag-indicator.row {
            writing-mode: vertical-lr;
        }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell { z-index: 1; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell:focus {z-index: 2; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell.input { z-index: 3 }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle { z-index: 31; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-selection { z-index: 35; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection { z-index: 36; }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> .frozen-row { z-index: 40; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell.input.frozen-row { z-index: 41; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle.frozen-row { z-index: 42; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-selection.includes-frozen-row { z-index: 43; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection.includes-frozen-row { z-index: 44; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle { z-index: 45; }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> .frozen-col { z-index: 50; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-cell.input.frozen-col { z-index: 51; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-resize-handle.frozen-col { z-index: 52; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-selection.includes-frozen-col { z-index: 53; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-copy-selection.includes-frozen-col { z-index: 54; }
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-reorder-handle.row { z-index: 55; }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2"> .frozen-col.frozen-row { z-index: 59; }
        
        </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-drag-indicator { z-index: 60; }
        
        .</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">tagName</span><span class="p">}</span><span class="s2">-menu { z-index: 70; }
        
    `</span><span class="p">}</span>
    
    <span class="nx">addEventListenerFor</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">addEventListenerFor</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">customElements</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="nx">Spreadsheet</span><span class="p">.</span><span class="nx">tagName</span><span class="p">,</span> <span class="nx">Spreadsheet</span><span class="p">);</span></code></pre></div>
        </div>
    </div>
</div>
    </div>
</body>
</html>
